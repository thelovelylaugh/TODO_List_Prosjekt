<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Index </title>

    <link rel="stylesheet" href="style.css">
    <i class="fas fa-trash-alt"></i> <!-- bruke denne istedenfor delete knapp??-->
    
    
</head>
<body>


    <!----------- HTML-elements -------------->
    
    <h1>To do list prosjekt </h1>
    <a href="todolist.html" class="button"> To do list</a>
    <a href="todolistcreate.html" class="button" >Create a new list</a>
    <a href="usercreate.html" class="button">Create a new user</a>
     
      <div class="container- signup">
         <h1> Sign Up</h1>
         <form action="" class="signup">
        <label for="user"><b>username</b></label>
        <input type="text" id="user" placeholder=" Enter username" required>
        <p></p>
        <label for="password"><b> Password</b></label>
        <input type="text" id="password" placeholder="Enter password" required><br>
        <p></p>
        
        <p></p>
        <button id="btnLogin">login</button>
        <a href="todolistcreate.html" class="button"><b>submit</b></a>
         </form>

      </div>

            
    <!------------- JavaScript --------------->
    <script>
        const user = document.getElementById("user");
        const password = document.getElementById("password");
        const btnLogin = document.getElementById("btnLogin");
        btnLogin.addEventListener("click", login);

        async function login(){
            let url = "/users/login"
            let credString = createCredentialString(user.value, password.value)

            let cfg = {
                method: "POST",
                headers: {"content-type": "application/json", "authrization": credString},
                
            };

            try{
                response = await fetch(url, cfg);
                let data = await response.json();

                localStorage.setItem("userid", data.id)
                
                console.log(data);

            }catch(err){
                console.log(err)
            }

        }
        function createCredentialString(username, password) {
            let combinedStr = username + ":" + password;
            let b64Str = btoa(combinedStr);
            return "basic " + b64Str;
        }
        
    </script>

 

    <!---------------- CSS ------------------->

 
</body>

</html>
